# Serena MCP å¿«é€Ÿå¼€å§‹æŒ‡å—

## ä»€ä¹ˆæ˜¯ Serena MCPï¼Ÿ

Serena MCP æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ä»£ç ç†è§£å·¥å…·ï¼Œä¸º `/wf_03_prime` å’Œå…¶ä»–å·¥ä½œæµå‘½ä»¤æä¾›ï¼š

- ğŸ§  **è¯­ä¹‰çº§ä»£ç ç†è§£** - ç†è§£ä»£ç ç»“æ„å’Œå…³ç³»
- ğŸ” **æ™ºèƒ½ç¬¦å·æŸ¥è¯¢** - å¿«é€Ÿå®šä½å‡½æ•°ã€ç±»ã€å˜é‡
- ğŸ“Š **é¡¹ç›®ç»“æ„åˆ†æ** - è‡ªåŠ¨ç”Ÿæˆæ¶æ„ç†è§£
- ğŸš€ **æ€§èƒ½ä¼˜åŒ–** - å‡å°‘ AI ä¸Šä¸‹æ–‡æ¶ˆè€—

## ä½¿ç”¨ Serena MCP

### 1. æ£€æŸ¥ Serena æ˜¯å¦æ­£å¸¸å·¥ä½œ

```bash
# è¿è¡Œè¯Šæ–­è„šæœ¬
bash scripts/diagnose_mcp.sh
```

**é¢„æœŸè¾“å‡º**ï¼š
```
âœ… uvx å·²å®‰è£…
âœ… Serena å¯ä»¥æ­£å¸¸å®‰è£…
ğŸ“Š é¡¹ç›®ç»Ÿè®¡...
âœ… Serena MCP æœåŠ¡å™¨å·²å¯åŠ¨
```

### 2. ä½¿ç”¨ `/wf_03_prime` åŠ è½½é¡¹ç›®ä¸Šä¸‹æ–‡

```bash
# æ ‡å‡†ç”¨æ³•ï¼ˆè‡ªåŠ¨ä½¿ç”¨ Serenaï¼‰
/wf_03_prime

# å¦‚æœ Serena ä¸å¯ç”¨ï¼Œç³»ç»Ÿè‡ªåŠ¨é™çº§åˆ°ä¼ ç»Ÿæ¨¡å¼
```

## å¸¸è§é—®é¢˜

### Q: Serena MCP è¿æ¥å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

**A**: æœ‰ä¸‰ä¸ªå¿«é€Ÿè§£å†³æ–¹æ¡ˆï¼š

1. **é‡å¯ Claude Code**ï¼ˆæˆåŠŸç‡ 80%ï¼‰
   ```bash
   pkill -f "claude"
   # é‡æ–°å¯åŠ¨ Claude Code
   /wf_03_prime
   ```

2. **è¿è¡Œè¯Šæ–­è„šæœ¬**ï¼ˆå‘ç°å…·ä½“é—®é¢˜ï¼‰
   ```bash
   bash scripts/diagnose_mcp.sh
   ```

3. **ä¸´æ—¶ç¦ç”¨ Serena**ï¼ˆå¿«é€Ÿè§„é¿ï¼‰
   - ç¼–è¾‘ `~/.claude/mcp.json`
   - æ³¨é‡Šæ‰ `"serena"` éƒ¨åˆ†
   - é‡å¯ Claude Code

### Q: Serena MCP å¾ˆæ…¢æ€ä¹ˆåŠï¼Ÿ

**A**: è¿™å¯èƒ½æ˜¯å› ä¸ºé¡¹ç›®ä»£ç åº“è¿‡å¤§ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š

1. **ä¼˜åŒ– `.gitignore`**
   ```bash
   # æ·»åŠ åˆ° .gitignore
   node_modules/
   venv/
   __pycache__/
   build/
   dist/
   .cache/
   ```

2. **æ£€æŸ¥é¡¹ç›®å¤§å°**
   ```bash
   bash scripts/diagnose_mcp.sh
   # æŸ¥çœ‹"ä»£ç æ–‡ä»¶æ•°"
   # å¦‚æœ > 1000ï¼Œè€ƒè™‘ä¼˜åŒ– .gitignore
   ```

### Q: å¦‚ä½•å®Œå…¨ç¦ç”¨ Serena MCPï¼Ÿ

**A**: ç¼–è¾‘ `~/.claude/mcp.json`ï¼š

```json
{
  "mcpServers": {
    // æ³¨é‡Šæ‰ä»¥ä¸‹éƒ¨åˆ†
    /*
    "serena": {
      "command": "uvx",
      "args": [
        "--from",
        "git+https://github.com/oraios/serena",
        "serena",
        "start-mcp-server",
        "--context",
        "ide-assistant",
        "--enable-web-dashboard",
        "false",
        "--enable-gui-log-window",
        "false"
      ]
    }
    */
  }
}
```

ç„¶åé‡å¯ Claude Codeã€‚

### Q: å¦‚ä½•äº†è§£æ›´å¤šï¼Ÿ

**A**: æŸ¥çœ‹è¯¦ç»†æ•…éšœæ’æŸ¥æŒ‡å—ï¼š

ğŸ‘‰ [docs/SERENA_MCP_TROUBLESHOOTING.md](SERENA_MCP_TROUBLESHOOTING.md)

## å·¥å…·å’Œè„šæœ¬

### è¯Šæ–­è„šæœ¬

**ä½ç½®**: `scripts/diagnose_mcp.sh`

**åŠŸèƒ½**:
- æ£€æŸ¥ `uvx` æ˜¯å¦å¯ç”¨
- æµ‹è¯• Serena å®‰è£…
- æ£€æŸ¥é¡¹ç›®å¤§å°
- è¯Šæ–­ MCP è¿æ¥
- æä¾›æ”¹è¿›å»ºè®®

**ä½¿ç”¨**:
```bash
bash scripts/diagnose_mcp.sh
```

### MCP ç®¡ç†å™¨

**ä½ç½®**: `src/mcp/serena_manager.py`

**åŠŸèƒ½**:
- æ£€æµ‹ Serena è¿æ¥çŠ¶æ€
- è‡ªåŠ¨é‡è¯•å¤±è´¥çš„è¿æ¥
- è‡ªåŠ¨é™çº§åˆ°ä¼ ç»Ÿæ¨¡å¼
- æä¾›è¯Šæ–­æ—¥å¿—

**ä½¿ç”¨**:
```bash
python src/mcp/serena_manager.py
```

### å¯åŠ¨å™¨

**ä½ç½®**: `scripts/wf_03_prime_launcher.py`

**åŠŸèƒ½**:
- è‡ªåŠ¨æ£€æµ‹æ‰§è¡Œæ¨¡å¼
- æ˜¾ç¤ºæ¨¡å¼ä¿¡æ¯å’Œå»ºè®®
- æä¾›è¯Šæ–­ä¿¡æ¯

**ä½¿ç”¨**:
```bash
python scripts/wf_03_prime_launcher.py
```

## æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | ä¼ ç»Ÿæ¨¡å¼ | Serena æ¨¡å¼ |
|------|---------|-----------|
| `/wf_03_prime` å¯åŠ¨æ—¶é—´ | 5-10s | 10-20s |
| ä¸Šä¸‹æ–‡æ¶ˆè€— | 200-300 tokens | 100-200 tokens |
| æ™ºèƒ½åŠŸèƒ½ | åŸºç¡€ | å®Œæ•´ |
| é™çº§é£é™© | æ—  | ä½ï¼ˆ<5%ï¼‰ |

## æœ€ä½³å®è·µ

### 1. å®šæœŸè¯Šæ–­

```bash
# æ¯å‘¨è¿è¡Œä¸€æ¬¡è¯Šæ–­
bash scripts/diagnose_mcp.sh
```

### 2. ä¼˜åŒ–é¡¹ç›®é…ç½®

```bash
# æ£€æŸ¥æœ€å¤§çš„æ–‡ä»¶å¤¹
du -sh * | sort -h | tail -10

# æ·»åŠ åˆ° .gitignore
echo "large_folder/" >> .gitignore
```

### 3. ç›‘æ§æ€§èƒ½

```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
WF03_VERBOSE=1 /wf_03_prime
```

## æ•…éšœæ’æŸ¥æµç¨‹å›¾

```
é‡åˆ° /wf_03_prime è¿æ¥é”™è¯¯
â”‚
â”œâ”€ Step 1: é‡å¯ Claude Code
â”‚  â””â”€ é—®é¢˜è§£å†³ï¼Ÿâ†’ å®Œæˆ
â”‚  â””â”€ é—®é¢˜ç»§ç»­ï¼Ÿâ†’ Step 2
â”‚
â”œâ”€ Step 2: è¿è¡Œè¯Šæ–­è„šæœ¬
â”‚  bash scripts/diagnose_mcp.sh
â”‚  â””â”€ æ ¹æ®è¾“å‡ºé€‰æ‹©æ–¹æ¡ˆ
â”‚
â”œâ”€ Step 3: å°è¯•å¿«é€Ÿè§£å†³æ–¹æ¡ˆ
â”‚  â”œâ”€ ä¼˜åŒ– .gitignore â†’ Step 2
â”‚  â”œâ”€ å¢åŠ ç³»ç»Ÿå†…å­˜ â†’ é‡å¯
â”‚  â””â”€ é—®é¢˜ä»æœªè§£å†³ï¼Ÿâ†’ Step 4
â”‚
â”œâ”€ Step 4: ä¸´æ—¶ç¦ç”¨ Serena
â”‚  ç¼–è¾‘ ~/.claude/mcp.jsonï¼Œæ³¨é‡Š serena éƒ¨åˆ†
â”‚  â””â”€ ç³»ç»Ÿé™çº§åˆ°ä¼ ç»Ÿæ¨¡å¼
â”‚
â””â”€ ä½¿ç”¨ä¼ ç»Ÿæ¨¡å¼ç»§ç»­å·¥ä½œ
   (æ€§èƒ½ç•¥æœ‰ä¸‹é™ï¼ŒåŠŸèƒ½å®Œæ•´)
```

## ä½•æ—¶è”ç³»æ”¯æŒ

å¦‚æœå°è¯•äº†æ‰€æœ‰ä¸Šè¿°æ­¥éª¤ä»ç„¶æ— æ³•è§£å†³ï¼Œè¯·æä¾›ï¼š

1. è¯Šæ–­è„šæœ¬çš„å®Œæ•´è¾“å‡º
   ```bash
   bash scripts/diagnose_mcp.sh > /tmp/diagnosis.txt 2>&1
   ```

2. Serena å¯åŠ¨æ—¥å¿—
   ```bash
   cat /tmp/serena_mcp.log
   ```

3. ç³»ç»Ÿä¿¡æ¯
   ```bash
   uname -a && python3 --version
   ```

## ç›¸å…³æ–‡æ¡£

- ğŸ“– [è¯¦ç»†æ•…éšœæ’æŸ¥æŒ‡å—](SERENA_MCP_TROUBLESHOOTING.md)
- ğŸ“š [é¡¹ç›® README](../README.md)
- ğŸ”§ [ä¸»æ•…éšœæ’æŸ¥æŒ‡å—](../TROUBLESHOOTING.md)
- ğŸš€ [é¡¹ç›®å¿«é€Ÿå¼€å§‹](../README.md#-å®‰è£…)

---

**ç‰ˆæœ¬**: 1.0
**æœ€åæ›´æ–°**: 2025-12-10
**ç›¸å…³å‘½ä»¤**: `/wf_03_prime`
