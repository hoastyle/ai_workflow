---
title: "wf_08_review 工作流指南"
description: "代码审查流程的详细执行指南、审查维度和标准输出模板"
type: "技术设计"
status: "完成"
priority: "高"
created_date: "2025-12-12"
last_updated: "2025-12-12"
related_documents:
  - "../../wf_08_review.md"
  - "../command_consistency_strategy.md"
  - "wf_08_review_parallel.md"
  - "wf_08_review_serena_guide.md"
related_code: []
---

# wf_08_review 工作流指南

本文档提供 `/wf_08_review` 命令的详细执行流程和标准化输出模板，确保代码审查的一致性和完整性。

---

## 🤖 AI执行协议（强制）

**本节为AI执行的强制规范，必须严格遵循，不得跳过或自行解释**

### 核心原则

1. **强制读取**: AI必须首先读取本文档的关键章节
2. **严格遵循**: 所有审查维度必须覆盖，不得遗漏
3. **标准输出**: 必须使用本文档提供的输出模板
4. **检查验证**: 完成前必须通过所有检查清单项
5. **客观评分**: 基于明确标准，而非主观判断

### 执行流程概览

```
Step 0: 读取本执行协议 (当前)
  ↓
Step 1: 识别变更范围（使用 Git diff）
  ↓
Step 2: 多维度审查（7个维度 + Ultrathink）
  ↓
Step 3: 评分和建议
  ↓
Final: 输出审查报告（使用标准模板）
```

---

## 📋 审查维度（强制覆盖）

AI必须覆盖以下所有审查维度：

### Dimension 1: 代码正确性 (Correctness)

**检查项**:
- [ ] 逻辑正确，无明显bug
- [ ] 边界条件处理完整
- [ ] 错误处理充分
- [ ] 输入验证完整

**评分标准**:
- 优秀 (9-10分): 逻辑严密，边界情况全覆盖
- 良好 (7-8分): 逻辑正确，少数边界情况待完善
- 需改进 (5-6分): 有逻辑问题或遗漏边界情况
- 不合格 (<5分): 明显bug或逻辑错误

### Dimension 2: 代码质量 (Code Quality)

**检查项**:
- [ ] 遵循项目编码规范
- [ ] 命名清晰且一致
- [ ] 函数/方法职责单一
- [ ] 代码可读性强

**评分标准**:
- 优秀 (9-10分): 完全符合规范，代码清晰优雅
- 良好 (7-8分): 基本符合规范，少数命名可改进
- 需改进 (5-6分): 有违反规范的地方
- 不合格 (<5分): 严重不符合规范

### Dimension 3: 架构对齐 (Architecture Alignment)

**检查项**:
- [ ] 符合 PLANNING.md 架构设计
- [ ] 模块划分合理
- [ ] 依赖关系清晰
- [ ] 与现有系统集成良好

**评分标准**:
- 优秀 (9-10分): 完全符合架构，集成顺畅
- 良好 (7-8分): 基本符合，有小幅调整
- 需改进 (5-6分): 有架构偏离
- 不合格 (<5分): 严重违反架构原则

### Dimension 4: 测试覆盖 (Test Coverage)

**检查项**:
- [ ] 有单元测试
- [ ] 测试覆盖关键路径
- [ ] 测试边界情况
- [ ] 测试可维护

**评分标准**:
- 优秀 (9-10分): 测试全面，边界情况完整
- 良好 (7-8分): 主要路径有测试
- 需改进 (5-6分): 测试覆盖不足
- 不合格 (<5分): 无测试或测试质量差

### Dimension 5: 性能考虑 (Performance)

**检查项**:
- [ ] 无明显性能瓶颈
- [ ] 算法复杂度合理
- [ ] 资源使用高效
- [ ] 符合性能要求

**评分标准**:
- 优秀 (9-10分): 性能优秀，超出要求
- 良好 (7-8分): 性能满足要求
- 需改进 (5-6分): 有性能问题
- 不合格 (<5分): 严重性能问题

### Dimension 6: 文档完整性 (Documentation)

**检查项**:
- [ ] 代码注释充分（复杂逻辑）
- [ ] API文档完整（如果有公开API）
- [ ] README/PLANNING.md已更新
- [ ] 变更说明清晰

**评分标准**:
- 优秀 (9-10分): 文档完整详细
- 良好 (7-8分): 文档基本完整
- 需改进 (5-6分): 文档不足
- 不合格 (<5分): 缺少关键文档

### Dimension 7: 安全性 (Security)

**检查项**:
- [ ] 无SQL注入/XSS等漏洞
- [ ] 敏感数据加密
- [ ] 输入验证完整
- [ ] 权限检查正确

**评分标准**:
- 优秀 (9-10分): 安全措施完善
- 良好 (7-8分): 基本安全
- 需改进 (5-6分): 有安全隐患
- 不合格 (<5分): 严重安全问题

### 🎨 Ultrathink 设计优雅度（可选）

**检查项** (参考 PHILOSOPHY.md):
- [ ] 函数/变量名字自然清晰
- [ ] 代码结构流畅易懂
- [ ] 错误处理优雅
- [ ] 无不必要的复杂性

---

## 🎯 标准输出模板（必须使用）

```markdown
## 📊 代码审查报告

**审查范围**: [简述变更内容]
**变更文件**: [列出文件]
**审查时间**: [时间戳]

### 评分总览

| 维度 | 评分 | 状态 |
|------|------|------|
| 代码正确性 | X/10 | [优秀/良好/需改进/不合格] |
| 代码质量 | X/10 | [优秀/良好/需改进/不合格] |
| 架构对齐 | X/10 | [优秀/良好/需改进/不合格] |
| 测试覆盖 | X/10 | [优秀/良好/需改进/不合格] |
| 性能考虑 | X/10 | [优秀/良好/需改进/不合格] |
| 文档完整性 | X/10 | [优秀/良好/需改进/不合格] |
| 安全性 | X/10 | [优秀/良好/需改进/不合格] |
| **总分** | **XX/70** | **[通过/需改进/不通过]** |

### 详细审查结果

#### ✅ 优点
1. [优点1]
2. [优点2]

#### ⚠️ 需要改进
1. [问题1]
   - 位置: [文件:行号]
   - 建议: [具体建议]
   - 优先级: [高/中/低]

2. [问题2]
   - 位置: [文件:行号]
   - 建议: [具体建议]
   - 优先级: [高/中/低]

#### 🚨 关键问题（如果有）
[列出必须修复的问题]

### 推荐下一步

**如果通过（总分 ≥ 49）**:
- [ ] `/wf_11_commit` - 提交代码

**如果需改进（35 ≤ 总分 < 49）**:
- [ ] 修复高优先级问题
- [ ] `/wf_08_review` - 重新审查

**如果不通过（总分 < 35）**:
- [ ] 修复所有关键问题
- [ ] 考虑重新设计
```

---

## ✅ 执行检查清单（AI必须验证）

在输出审查报告前，AI必须确认以下所有项目：

- [ ] ✅ 已读取本工作流指南的"AI执行协议"部分
- [ ] ✅ 已使用 Git diff 识别所有变更文件
- [ ] ✅ 已覆盖所有7个审查维度（无遗漏）
- [ ] ✅ 每个维度都有明确的评分和依据
- [ ] ✅ 已提供具体的改进建议（位置+建议）
- [ ] ✅ 总分计算正确
- [ ] ✅ 输出格式符合标准模板
- [ ] ✅ 遵循CLAUDE.md语言规范

**如果任何检查项未通过，必须重新执行对应步骤**

---

## 🔄 后续工作流路径

完成代码审查后，根据结果选择下一步：

| 审查结果 | 推荐命令 | 说明 |
|---------|---------|------|
| 通过（≥49分） | `/wf_11_commit` | 提交代码 |
| 需改进（35-48分） | 修复 → `/wf_08_review` | 修复后重新审查 |
| 不通过（<35分） | `/wf_09_refactor` | 重构代码 |
| 有安全问题 | 立即修复 | 安全问题优先级最高 |

---

**相关文档**:
- 主命令文件: [wf_08_review.md](../../wf_08_review.md)
- 并行审查策略: [wf_08_review_parallel.md](wf_08_review_parallel.md)
- Serena MCP 指南: [wf_08_review_serena_guide.md](wf_08_review_serena_guide.md)
- 一致性策略: [command_consistency_strategy.md](command_consistency_strategy.md)
