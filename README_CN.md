# Claude Code 工作流命令系统 (wf_*) - v2.0 优化版

一套为 Claude Code 设计的精简闭环工作流系统，集成了项目规划、任务管理和开发最佳实践。

## 🎯 目标

该命令套件提供了结构化的工作流程：
- 使用 PLANNING.md、TASK.md 和 CONTEXT.md 在会话间维护上下文
- 通过 `/clear` 边界实现工作连续性
- 自动跟踪整个开发过程的进度
- 执行一致的模式和质量标准
- 创建从规划到部署的完整开发循环
- **v2.0 新特性**: 减少28%复杂度 (18→13个命令)，集成相关功能

## 🚀 快速开始

1. **初始化项目**
   ```bash
   @wf_planning.md 我的项目
   @wf_task.md create
   ```

2. **开始工作会话**
   ```bash
   @wf_prime.md  # 加载项目上下文
   ```

3. **开发功能**
   ```bash
   @wf_code.md 实现用户认证功能    # 自动格式化
   @wf_test.md 认证模块            # 包含覆盖率分析
   @wf_commit.md                  # 自动更新上下文
   ```

4. **中断后继续**
   ```bash
   /clear  # 当上下文过大时清理
   @wf_prime.md  # 无缝重新加载并继续
   ```

## 📁 优化命令架构 (13个命令)

### 🔄 核心工作流 (3个)
| 命令 | 用途 | 新功能 |
|---------|---------|-------------|
| `wf_prime.md` | 加载项目上下文 | 现在读取 CONTEXT.md 获取会话状态 |
| `wf_planning.md` | 创建/更新项目架构 | 增强文档功能 |
| `wf_task.md` | 管理任务跟踪和进度 | 改进自动化 |

### 💻 开发 (4个)
| 命令 | 用途 | 集成功能 |
|---------|---------|-------------|
| `wf_code.md` | 实现与架构对齐的功能 | 内置自动格式化 |
| `wf_ask.md` | 在项目上下文中获取架构咨询 | 增强多代理系统 |
| `wf_debug.md` | 系统化地调试和修复问题 | **合并了 wf_fix.md** |
| `wf_refactor.md` | 改进代码结构 | 保持不变 |

### ✅ 质量保证 (3个)
| 命令 | 用途 | 集成功能 |
|---------|---------|-------------|
| `wf_test.md` | 创建和运行测试 | **合并了 wf_coverage.md** |
| `wf_review.md` | 根据标准审查代码 | 格式验证 |
| `wf_optimize.md` | 优化性能 | 保持不变 |

### 🔧 运维 (2个)
| 命令 | 用途 | 集成功能 |
|---------|---------|-------------|
| `wf_deploy_check.md` | 验证部署准备情况 | 保持不变 |
| `wf_commit.md` | 完全自动化的提交 | **合并了 wf_format.md + 自动 CONTEXT.md 更新** |

### 📚 帮助 (1个)
| 命令 | 用途 | 集成功能 |
|---------|---------|-------------|
| `wf_help.md` | 完整帮助系统 | **合并了 wf_guide.md + wf_quick.md** |

## 🔄 工作流示例

### 完整功能开发
```bash
# 1. 架构咨询
@wf_ask.md 如何设计认证系统的架构？

# 2. 实现（自动格式化）
@wf_code.md 实现基于JWT的认证

# 3. 测试（包含覆盖率分析）
@wf_test.md 认证接口

# 4. 审查
@wf_review.md 认证模块

# 5. 提交（自动格式化，更新上下文）
@wf_commit.md feat: 添加JWT认证

# 6. 更新任务（由提交自动更新）
@wf_task.md update
```

### Bug 修复流程
```bash
# 1. 调试和修复（统一命令）
@wf_debug.md 用户登录时出现500错误

# 2. 测试修复
@wf_test.md 并发登录场景

# 3. 提交（自动格式化，上下文更新）
@wf_commit.md fix: 解决登录竞态条件
```

### 会话管理
```bash
# 开始一天的工作
@wf_prime.md              # 加载所有上下文包括 CONTEXT.md
@wf_task.md review

# ... 功能开发 ...

# 休息前
@wf_commit.md              # 自动更新 CONTEXT.md

# 休息后（新会话）
/clear
@wf_prime.md              # 从 CONTEXT.md 无缝恢复
# 从中断处继续
```

## 📋 关键文件（闭环）

### PLANNING.md
架构蓝图，包含：
- 项目概述和目标
- 系统架构
- 技术决策
- 开发标准
- 测试策略

### TASK.md
动态进度跟踪器，包含：
- 分类任务列表
- 当前状态
- 依赖关系
- 完成历史

### CONTEXT.md ⭐ (v2.0 新增)
会话状态管理器，包含：
- 最近会话完成的工作
- 关键决策记录
- 当前关注领域
- 下一步优先项目
- **由 wf_commit.md 自动更新**

## 🏗️ 设置

1. **在项目中创建命令目录：**
   ```bash
   mkdir -p .claude/commands
   ```

2. **复制所有 wf_*.md 文件到命令目录**

3. **初始化项目：**
   ```bash
   @wf_planning.md 你的项目名称
   @wf_task.md create
   ```

4. **开始开发！**

## 💡 最佳实践

1. **清理上下文后始终加载** - `/clear` 后运行 `@wf_prime.md`
2. **让自动化为你工作** - `@wf_commit.md` 处理格式化和上下文更新
3. **使用统一命令** - `@wf_debug.md` 既可调试也可修复
4. **测试时检查覆盖率** - `@wf_test.md --coverage` 进行覆盖率分析
5. **轻松获取帮助** - `@wf_help.md quick` 快速查看命令参考

## 🔍 v2.0 优化摘要

### 删除的命令 (5个)
- ❌ `wf_fix.md` → 合并到 `wf_debug.md`
- ❌ `wf_format.md` → 集成到 `wf_commit.md`
- ❌ `wf_coverage.md` → 合并到 `wf_test.md`
- ❌ `wf_guide.md` → 合并到 `wf_help.md`
- ❌ `wf_quick.md` → 合并到 `wf_help.md`

### 增强的命令
- ✅ **wf_commit.md**: 自动格式化 + CONTEXT.md 更新
- ✅ **wf_prime.md**: 读取 CONTEXT.md 实现会话连续性
- ✅ **wf_debug.md**: 统一调试修复，支持 `--quick` 模式
- ✅ **wf_test.md**: 集成覆盖率分析，支持 `--coverage` 标志
- ✅ **wf_help.md**: 完整帮助系统，支持快速/指导模式

### 新功能
- 🆕 **CONTEXT.md**: 自动会话状态管理
- 🆕 **自动格式化**: 提交工作流中的多语言格式化
- 🆕 **无缝会话**: 跨 `/clear` 边界的完美连续性
- 🆕 **统一操作**: 降低认知负担，更专注于开发

## 📊 工作流优势

- **上下文保持**: 通过 CONTEXT.md 跨会话顺畅工作
- **进度跟踪**: 始终了解完成情况和下一步
- **质量执行**: 自动应用一致的标准
- **减少开销**: 28%更少的命令，集成功能
- **完整循环**: 从规划到部署的一体化精简系统

## 🛠️ 故障排除

### 丢失上下文？
```bash
@wf_prime.md  # 从所有核心文件重新加载所有内容
```

### 需求不明确？
```bash
@wf_ask.md [你的问题]
```

### 需要质量检查？
```bash
@wf_review.md [范围]
@wf_test.md --coverage
```

### 准备部署？
```bash
@wf_deploy_check.md production
```

### 获取帮助？
```bash
@wf_help.md           # 主帮助菜单
@wf_help.md quick     # 命令参考
@wf_help.md guide     # 工作流场景
```

## 📈 持续改进

系统通过以下方式演进：
- 定期更新 PLANNING.md
- 任务模式分析
- 命令优化
- 工作流改进
- 用户反馈集成

## 🔮 未来展望

未来改进可能包括：
- 进一步自动化增强
- 更多语言的格式化支持
- 增强的上下文分析
- 性能优化

## 🔑 核心理念

### 1. 上下文持久化
通过 PLANNING.md（架构文档）、TASK.md（任务跟踪）和 CONTEXT.md（会话状态）保存项目状态，即使在 `/clear` 后也能快速恢复工作状态。

### 2. 闭环工作流
每个命令都是整体工作流的一部分：
- 规划 → 开发 → 测试 → 审查 → 部署
- 每步都更新相应文档
- 自动维护项目连续性

### 3. 智能上下文管理
```bash
长时间工作 → 上下文变大 → /clear 清理 → @wf_prime.md 恢复 → 无缝继续工作
```

### 4. 任务驱动开发
- 所有工作都与 TASK.md 中的任务关联
- 自动跟踪进度
- 清晰的依赖关系管理

### 5. 自动化质量保证
- 提交时自动格式化
- 集成的测试覆盖率分析
- 标准化的代码审查流程

## 📚 使用场景

### 新项目启动
1. 创建项目规划 (`@wf_planning.md`)
2. 生成任务列表 (`@wf_task.md create`)
3. 开始迭代开发 (`@wf_prime.md`)

### 日常开发
1. 加载上下文 (`@wf_prime.md`)
2. 选择任务 (`@wf_task.md review`)
3. 开发-测试-提交循环
4. 自动更新进度

### 代码维护
1. 审查现有代码 (`@wf_review.md`)
2. 识别改进点
3. 重构和优化 (`@wf_refactor.md`)
4. 验证无回归 (`@wf_test.md`)

### 紧急修复
1. 快速调试 (`@wf_debug.md --quick`)
2. 实施修复
3. 验证解决 (`@wf_test.md`)
4. 自动记录经验

## 🎯 设计目标

1. **最小化上下文负担** - 通过文档持久化减少重复
2. **最大化工作连续性** - 无缝跨会话工作
3. **自动化质量保证** - 内置标准执行
4. **透明进度跟踪** - 实时了解项目状态
5. **简化操作流程** - 减少命令数量，集成相关功能

---

**注意**: 所有命令使用 `wf_` 前缀以区别于其他命令系统。这确保了清晰的命名空间分离和工作流命令的易识别性。

**从 v1.0 迁移**: 现有项目将无缝工作 - 已删除的命令将显示有用的错误消息，指向其替代命令。

## 联系与反馈

如有问题或建议，请通过项目仓库提交 Issue 或 Pull Request。